Geoprocessing tools for vector data: buffer
===========================================

A buffer is the respect area within a fixed distance from a geographic element. It is a very useful tool in proximity analyses. Two types of buffer may be created: a fixed distance buffer and a variable (or dynamic) distance buffer. Let us suppose that we want to create a respect area around the river network. With a first example, we are going to create a fixed-distance buffer, equal for every river segment; afterwards, we are going to create a variable-distance buffer, depending on the river length.
For this purpose, let us first calculate the length of every river network segment with the field calculator. Let us start an editing session: right click on the layer River_network → **Toggle editing**. Open the attribute table of River_network and click **New field**. Name the new field “Length” and assign the **Type** “**Decimal number (real)**”. **Open field calculator**, check the option **Update existing field** and select Length as the field to be updated. In the Expression tab, search for and double-click **Geometry → $length**. Finally, click **OK** and the length of every feature shall be calculated. Save and stop the editing session.

Now we can create a fixed-distance buffer around the river network. Let us suppose to use a distance of 50 m. In the main menu, select **Vector → Geoprocessing Tools → Buffer**. In the configuration interface, select as **Input layer** “River_networ” and assign 50 meters in the **Distance** bar; check the option **Dissolve result** and save the buffer area as a new shapefile, specifying an adequate path (clicking the ellipses symbol). Let us name the new shapefile “River_network_buffer_fixed”. Figure 2.4.6.1 shows the configuration interface for a fixed-distance buffer as well as the resulting layer (in yellow).

.. _2.4.6.1:
.. figure:: /img/2/2.4.6.1.PNG
   
    -- Configuration interface to create a fixed-distance buffer.

Now we are going to create a variable-distance buffer around the river network. In particular, the distance will be equal to 50 m for rivers with length higher than 50 km and 20 m for those with length lower than 50 km.

For this purpose, let us add a new field to the shapefile River_network to differentiate between two buffer distances: **Toggle editing** on the layer River_network, open its attribute table and select **New field**. Let us call the new field “Distance” and assign the **Type** “**Whole number (integer)**”. Now, let us use the tool **Select by Expression** that we have previously described, in order to select the river segments with length higher than 50 km: let us write the expression “Length → 50000” and click **Select Features**. Now that the selection has been applied, open the **Field calculator** and select **Update existing field** (choosing the field “Distance”), write in the expression tab the number 50 and click **OK**. Then, use the **Invert selection** tool to select the river segments shorter than 50 km: with the **Field calculator**, assign the value 20 to the selected features in the field “Distance”. Finally, deselect all features, save and stop the editing session.

Now we can create the two buffer areas. Let us open the configuration interface: **Vector → Geoprocessing Tools → Buffer**. Select as **Input layer** “River_network” and, in the Distance tab, select **Data defined override → Field type: int, double, string → Distance (integer)**. Then, check the tab **Dissolve result** and name the resulting shapefile “River_network_buffer_variable”, choosing an adequate path (usual folder of the exercise session). Finally, click **Run**. :numref:`2.4.6.2` shows the configuration interface for the variable-distance buffer as well as the resulting layer (in orange).

.. _2.4.6.2:
.. figure:: /img/2/2.4.6.2.PNG
   
    -- Configuration interface to create a variable-distance buffer. The result (buffer area) is shown: River_network_buffer_variable (orange polygon).