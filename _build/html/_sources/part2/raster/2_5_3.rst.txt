Raster calculator
=================

The Raster Calculator tool allows to perform calculations based on the raster pixel values. Calculations are computed on each pixel value and the result is a new raster whose pixel values are the corresponding results from calculations on the corresponding pixels. It is a great tool that can be useful for several applications and for very different operations to apply.

Let us apply it on *Temperature_distribution* raster data. Suppose that we want to find out the areas in the lakes with the lowest water surface temperatures. First, look at the distribution of values in the raster: the highest detected temperatures are obviously distributed along the borders of the lakes and are fewer with respect to the lower temperatures in the centre of the lakes. It is possible to look also at the raster data histogram (**Properties→histogram**) to see that the most of values are around 12,5°, thus, to find out where the lowest temperatures are localised, let us consider 12° as temperature of reference.

Now, apply **Raster Calculator**. See :numref:`2.5.3` for the steps. Under **Raster** Menu go to **Raster Calculator**…: it will open a window where to insert the following operation **(1)** to be performed:

::

    ("Temperature_distribution@1"/"Temperature_distribution@1") * ((Temperature_distribution@1"< 12)  *
    * 1 + ("Temperature_distribution@1" >= 12) * 2 )

Particularly, with Raster Calculator, it is recommendable to insert the different signs and layers through *Operators* and *Raster Bands* buttons.

Our operation is mostly of a logical type (using < and >=): in QGIS, the results of a logical formula can be 1=True or 0=False: therefore, when we input, for example, (Temperature_distribution@1"< 12)* 1  the result here will be 1 or 0 for each pixel, summed to the result of ("Temperature_distribution@1" >= 12 ) * 2 that will be 0 or 2. Obviously one number cannot be contemporarily < or >= 12 therefore the result of the whole second parenthesis will be 1 or 2. In reality, for this case, QGIS would give also 0 result, because it takes *nan* pixels values of "Temperature_distribution@1" as neither smaller or higher than 12: it is for this reason that we multiply the result of the logical second parenthesis to the first division, to mask out these 0 results.

Before running the computation insert in **(2)** where to save the new raster layer: when choosing for the name of the new raster you can use *lowest_temperatures*.

After running, a new raster layer will be added to your QGIS project. After changing its render type to *Paletted/unique values*, you should get a result similar to the one in :numref:`2.5.3` with pixels with only 1 and 2 values.

.. _2.5.3:
.. figure:: /img/2/2.5.3.png
   
    -- Raster Calculator steps and result.